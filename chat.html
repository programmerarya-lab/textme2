<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Detective Groupchat</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<style>
  body{margin:0;background:#050510;color:#eee;font-family:monospace;display:flex;flex-direction:column;height:100vh;}
  header{background:linear-gradient(90deg,#0ff,#08f);color:#000;padding:10px;text-align:center;font-weight:bold;}
  #chat{flex:1;overflow-y:auto;padding:10px;display:flex;flex-direction:column;gap:8px;}
  .msg{padding:8px 12px;border-radius:8px;max-width:80%;word-break:break-word;animation:fade 0.3s;}
  .me{align-self:flex-end;background:#0ff2;border:1px solid #0ff;}
  .other{align-self:flex-start;background:#f022;border:1px solid #f44;}
  #inputBox{display:flex;}
  #inputBox input{flex:1;padding:10px;background:#111;color:#0ff;border:none;outline:none;}
  #inputBox button{padding:10px;background:#08f;color:#fff;border:none;cursor:pointer;}
  @keyframes fade{from{opacity:0;transform:translateY(5px);}to{opacity:1;transform:translateY(0);}}
  .overlay{position:absolute;inset:0;pointer-events:none;background:repeating-linear-gradient(45deg,rgba(0,255,255,0.05) 0,rgba(0,255,255,0.05) 2px,transparent 2px,transparent 6px);mix-blend-mode:difference;animation:move 5s linear infinite;}
  @keyframes move{from{background-position:0 0;}to{background-position:200px 200px;}}
</style>
</head>
<body>
<header>Detective Chat <button onclick="window.location='decrypt.html'">Decrypt Tool</button></header>
<div id="chat"></div>
<div id="inputBox">
  <input id="msg" placeholder="Type...">
  <button onclick="sendText()">Send</button>
  <button onclick="sendEncrypted()">Encrypt</button>
</div>
<div class="overlay"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<script>
const username=sessionStorage.getItem("username")||"Anon";
const chat=document.getElementById("chat");


let messages=[];

function render(msg,user,me=false){
  let div=document.createElement("div");
  div.className="msg "+(me?"me":"other");
  div.textContent=user+": "+msg;
  chat.appendChild(div);
  chat.scrollTop=chat.scrollHeight;
  setTimeout(()=>div.remove(),4000); 
}

function sendText(){
  let val=document.getElementById("msg").value.trim();
  if(!val) return;
  render(val,username,true);
  document.getElementById("msg").value="";
}

function sendEncrypted(){
  let plain=prompt("Enter text to encrypt:");
  if(!plain) return;
  let code=prompt("Enter secret code:");
  if(!code) return;
  let enc=CryptoJS.AES.encrypt(plain,code).toString();
  render("[ENCRYPTED] "+enc,username,true);
}
</script>
</body>
</html>
